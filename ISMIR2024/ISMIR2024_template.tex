% SIMILAR ISMIR PAPERS
% https://archives.ismir.net/ismir2023/paper/000045.pdf (I'm modeling my paper mostly from this)
% https://tomcollinsresearch.net/pdf/ismirReviewExamples.pdf (these are examples of ISMIR papers that aren't necessarily similar but have been heavily commented on by actual ISMIR reciewers)

% -----------------------------------------------
% Template for ISMIR Papers
% 2023 version, based on previous ISMIR templates

% Requirements :
% * 6+n page length maximum
% * 10MB maximum file size
% * Copyright note must appear in the bottom left corner of first page
% * Clearer statement about citing own work in anonymized submission
% (see conference website for additional details)
% -----------------------------------------------

\documentclass{article}
\usepackage[T1]{fontenc} % add special characters (e.g., umlaute)
\usepackage[utf8]{inputenc} % set utf-8 as default input encoding
\usepackage{ismir,amsmath,cite,url}
\usepackage{graphicx}
\usepackage{color}

\usepackage{lineno}
\linenumbers

% Title. Please use IEEE-compliant title case when specifying the title here,
% as it has implications for the copyright notice
% ------
\title{Synthesizing Flexible, Composite Hierarchical Structure from Music Datasets}

% Note: Please do NOT use \thanks or a \footnote in any of the author markup

% Single address
% To use with only one author or several with the same address
% ---------------
\oneauthor
	{Ilana Shapiro}
	{UC San Diego \\ {\tt ilshapiro@ucsd.edu}}
 %{Names should be omitted for double-blind reviewing}
 %{Affiliations should be omitted for double-blind reviewing}

% Two addresses
% --------------
%\twoauthors
%  {First author} {School \\ Department}
%  {Second author} {Company \\ Address}

% Three addresses
% --------------\input{ISMIR2021_paper.tex}

%\threeauthors
%  {Ilana Shapiro} {Affiliation1 \\ {\tt author1@ismir.edu}}
%  {Second Author} {\bf Retain these fake authors in\\\bf submission to preserve the formatting}
%  {Third Author} {Affiliation3 \\ {\tt author3@ismir.edu}}

% Four or more addresses
% OR alternative format for large number of co-authors
% ------------
%\multauthor
%{First author$^1$ \hspace{1cm} Second author$^1$ \hspace{1cm} Third author$^2$} { \bfseries{Fourth author$^3$ \hspace{1cm} Fifth author$^2$ \hspace{1cm} Sixth author$^1$}\\
%  $^1$ Department of Computer Science, University , Country\\
%$^2$ International Laboratories, City, Country\\
%$^3$  Company, Address\\
%{\tt\small CorrespondenceAuthor@ismir.edu, PossibleOtherAuthor@ismir.edu}
%}

% For the author list in the Creative Common license, please enter author names. 
% Please abbreviate the first names of authors and add 'and' between the second to last and last authors.
\def\authorname{Ilana Shapiro}

% Optional: To use hyperref, uncomment the following.
%\usepackage[bookmarks=false,pdfauthor={\authorname},pdfsubject={\papersubject},hidelinks]{hyperref}
% Mind the bookmarks=false option; bookmarks are incompatible with ismir.sty.

\sloppy % please retain sloppy command for improved formatting

\begin{document}

%
\maketitle
%

%We adopt a ``(6+n)-page policy'' for ISMIR \conferenceyear. That is, each paper may have a maximum of six pages of technical content (including figures and tables) \textcolor{red}{with additional optional pages that contain only references and acknowledgments. Note that acknowledgments should not be included in the anonymized submission.}
%Paper should be submitted as PDFs and the \textcolor{red}{file size is limited to 10MB}. Please compress images and figures as necessary before submitting.

\begin{abstract}
Music is an innately hierarchical system, comprising multiple semantic levels informed by music theory. Such levels include formal structure segmentation, disjoint motif repetition, and harmonic and melodic contour. Historically, researchers in the music information retrieval community have focused on developing analyses for single levels in this hierarchy. However, existing research has addressed neither (1) how to combine arbitrarily many levels of structure analyses into a single unified model and (2) how to extract a representative such structure from a corpus of music, rather than just a single piece. In this work, we propose a novel data structure called the \textit{semantic temporal graph} that captures the semantic (i.e. music theoretic) relationships between levels of the hierarchy, as well as the temporal relationships between adjacent-level analyses. Furthermore, given a corpus of such graphs derived from individual pieces, we introduce a method rooted in stochastic optimization to derive a representative $centroid$ graph encoding the music dataset's overall structure. We provide a qualitative evaluation of the semantic temporal graph [where we.....], as well as a quantitative evaluation of the centroid graph [where we...].
% and evaluate??
\end{abstract}


%
\section{Introduction}\label{sec:intro}
Music is both composed and comprehended with a hierarchical organization. Individual notes constitute the bottom of the hierarchy, followed by harmony, rhythmic patterns, motives, phrases, and finally large scale sections. Together, this hierarchy defines the overall structure of a piece \cite{msaf}.

Automatic identification of musical structure, also known as \textit{music structure analysis} (MSA), continues to be a major interest to both musicologists and the MIR community. Research thus far has focused on the automatic contiguous segmentation (both flat and hierarchical) of musical form \cite{msaf, checkerboard, sf, vmo_segmentation, cnmf, 2dfmc, eval_hier, olda, scluster, musicaiz, repetition_grammars_ismir2023, buisson_2022, cmu_dannenberg_2020}, which involves a boundary detection step followed by a segment labeling step, as well as motif detection \cite{Hsiao_2023_motifs, vmo_motifs}, which looks for disjoint repeating musical patterns. More recently, researchers have also developed avenues for harmonic \cite{chen_2019_harmony}, functional harmonic \cite{chen_2018_harmony}, and melodic \cite{salamon_2013_melody, kosta_22_melody, chou2021_melody_midibert} contour extraction. The techniques used are diverse, ranging from matrix factorization to deep learning in both supervised and unsupervised settings. All of these tasks have been proposed in annual competitions of the Music Information Retrieval eXchange (MIREX) \cite{MIREX_2017_form, MIREX_2017_motif, MIREX_2010_harmony}, which provides a standard format for their outputs. 

To our knowledge, all existing MSA research addresses a single aspect of the compositional hierarchy, such as motif extraction, or melodic contour. There is currently no notion of how reconcile differing levels of the hierarchy into a single, unified model of structure, even though their amalgamation is central to a piece's compositional architecture and cohesive integrity. In identifying the critical components necessary for integrating the hierarchical levels, we find that there are two central challenges: how to convey each level's semantic, music theoretic level in the hierarchy, and how to encapsulate the temporal relationships between the results of structural analyses at adjacent hierarchical levels. 

Furthermore, prior MSA research has only addressed the problem of identifying structure in a single piece, and there is presently no methodology for describing the overall structure of a musical corpus, even across existing single-level analyses. The one exception is Oriol Nieto's proposed technique for merging multiple segment boundary annotations \cite{msaf}, but this is intended to be used with multiple boundary detection algorithms over a single piece to alleviate the problem of subjectivity, and does not address the problem of reconciling differing labels.  

To address the first gap, in Section \ref{sec:representation}, we develop the notion of a \textit{semantic temporal graph} (STG), a k-partite directed acyclic graph (DAG) where semantic, music theoretic levels of the compositional hierarchy are represented as levels in the k-partite structure, nodes represent structure labels that are the results of the relevant analysis at each level, and edges between nodes of adjacent levels convey the temporal relationships between those structure labels. Each node has an associated time interval determined by the relevant MSA algorithm. A node must have one or two parents at the level above it: one if its associated time interval is a total subset of its parents, and two if its time interval begins in one parent and ends in the other. In order to easily parse the results of MSA algorithms into this data structure, the standard MIREX format is adhered to. 

Importantly, the STG is incredibly flexible, and supports the representation of arbitrarily many layers and layer types. Furthermore, the STG is totally decoupled from any specific MSA algorithm or input format, meaning that the chosen MSA algorithm for any level can be easily swapped out, as long as its output adheres to the standard MIREX format. This is crucial as single-level MSA algorithms are constantly improving, and the STG must be adaptable enough to accommodate this.

Finally, to address the second gap, in Section \ref{sec:synthesis} we examine the problem of finding a \textit{centroid}, or most representative, graph given a corpus of the k-partite semantic temporal DAGs derived from individual pieces. We use the label-aware graph edit distance as the similarity metric between two graphs. Given such a set of graphs $G$, we seek to construct the STG $g*$ that minimizes this distance from $g*$ to every graph in $G$. This is a constraint satisfaction problem, but one that is intractable to solve deterministically. Thus, we must rely on approximation techniques, and utilize Markov Chain Monte Carlo methods, demonstrating how to use the Metropolis Hastings algorithm to infer an optimal solution and thus arrive at the centroid graph most descriptive of the entire corpus by construction. 



\section{Related work}\label{sec:related_work}
The majority of existing MSA algorithms focus on the contiguous formal segmentation task: boundary detection, followed by section labeling. Segmentation algorithms can be flat or hierarchical (where each level is an increasingly granular contiguous segmentation of the piece). Existing approaches generally utilize matrix factorization, formal grammars, or more recently, neural networks. Oriol Nieto's Music Structure Analysis Framework (MSAF) toolkit \cite{msaf} features most of the state-of-the art matrix factorization approaches for audio, including ordinal linear discriminant analysis \cite{olda}, convex nonnegative matrix factorization \cite{cnmf}, checkerboard \cite{checkerboard}, spectral clustering \cite{scluster}, the Structural Features algorithm \cite{sf}, 2D-Fourier Magnitude Coefficients \cite{2dfmc}, and the Variable Markov Oracle \cite{vmo_segmentation}. These methods use variants of self-similarity matrices (SSMs) for boundary detection, which are symmetric matrices storing pair-wise comparisons between a given set of features. To assign labels, various methods including Gaussian mixture models and nearest neighbor search are employed \cite{msaf}. 

More recently, both supervised \cite{wang_2021} and unsupervised \cite{mccallum_2021, buisson_2022} deep learning approaches to segmentation have studied, as have graph- and grammar-based approaches. Hernandez-Olivan et al. use the graph-based G-PELT algorithm \cite{musicaiz}, while Dai et al. employ a graph-based approach informed by interactions between sections, melody, harmony and rhythm \cite{cmu_dannenberg_2020}. In the grammar realm, Finkensiep et al. attempt a unified model of structure by using a minimal context-free grammar to combine repetition with formal prototypes in a tree-based approach, but they still only operate within the contiguous segmentation domain \cite{repetition_grammars_ismir2023}. 

MSA algorithms also extend to motif detection, harmonic analysis, and melody extraction. Motif extraction algorithms, which search for disjoint, repeating, and possibly overlapping patterns in a piece, generally fall into three categories: string-based approaches, where music data is represented as a one-dimensional pitch sequence repeated patterns are detected with sub-string matching; geometry-based approaches, which represents music data as multidimensional point sets

, where music data is represented as multidimensional point sets \cite{Hsiao_2023_motifs}, as well as with string-based methods, such as 
by the Variable Markov Oracle, which uses a  string-based method in which input features are symbolized and
repeated suffixes are located within the time series \cite{motifs}.

harmony (NN)

melody (salamon paper + NN approaches)

As for a model unifying 
prototype graph

\section{Formats and Parsing}\label{sec:formats}
\subsection{MIREX Standard Formats} \label{subsec:MIREX}
\subsection{Parsing} \label{subsec:parsing}

\section{Abstract Representation}\label{sec:representation}

\subsection{Semantic Temporal Graph} \label{subsec:st_graph}

\section{Synthesis} \label{sec:synthesis}

%\section{Evaluation} \label{subsec:eval}

\section{Conclusions and Future Work}


%\section{Acknowledgments}
%\textbf{Do not include in your submission, only in your camera ready version}. This section can be used to refer to any individuals or organizations that should be acknowledged in this paper. This section does \textit{not} count towards the page limit for scientific content.


% bib sources list:
% https://archives.ismir.net/ismir2023/paper/000045.pdf (new ISMIR paper on hierarchical grammars)
% https://archives.ismir.net/ismir2014/paper/000226.pdf (previous work on grammar extraction for form)
% https://archives.ismir.net/ismir2019/paper/000039.pdf (grammar for Harmony -- didn't include in bib)
% https://citeseerx.ist.psu.edu/document?repid=rep1&type=pdf&doi=a602b8d972f68b100350c5dc54681cc44f31493a (sCluster)
% https://www.ee.columbia.edu/~dpwe/pubs/McFeeE14-segments.pdf (OLDA)
% https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2017.01337/full (evaluating hierarchical analyses)
% https://ccrma.stanford.edu/~urinieto/MARL/publications/Nieto-Dissertation.pdf (MSAF)
% https://ccrma.stanford.edu/~urinieto/MARL/publications/NietoBello-ICASSP14.pdf (2D-FMC)
% https://cacm.acm.org/research/stochastic-program-optimization/ (stochastic program optimization)
% https://escholarship.org/uc/item/7tg5c8rb / https://www.semanticscholar.org/paper/Structural-segmentation-with-the-Variable-Markov-Wang-Mysore/1f9ac4bb9527d47deec00f24efd72d7c1796ca0c / https://www.ismir2015.uma.es/articles/78_Paper.pdf(VMO)
% https://ismir2023program.ismir.net/poster_145.html (motif extraction)
% https://proceedings.neurips.cc/paper_files/paper/2022/hash/f13ceb1b94145aad0e54186373cc86d7-Abstract-Conference.html (halley, prototype graph)
% https://arxiv.org/pdf/2209.07974.pdf / https://www.sciencedirect.com/science/article/pii/S2352711023000614 (musicaiz)
% https://hal.science/hal-03278537/ (morpheauS)
% https://ismir2018.ircam.fr/doc/pdfs/178_Paper.pdf (harmony 1)
% https://archives.ismir.net/ismir2019/paper/000030.pdf (harmony 2)
% https://arxiv.org/pdf/2107.05223.pdf (melody 1)
% https://archives.ismir.net/ismir2022/paper/000091.pdf (melody 2)
% https://www.justinsalamon.com/uploads/4/3/9/4/4394963/jsalamon_phdthesis.pdf (melody 3)



\bibliography{ISMIRtemplate}

% For non bibtex users:
%\begin{thebibliography}{citations}
% \bibitem{Author:17}
% E.~Author and B.~Authour, ``The title of the conference paper,'' in {\em Proc.
% of the Int. Society for Music Information Retrieval Conf.}, (Suzhou, China),
% pp.~111--117, 2017.
%
% \bibitem{Someone:10}
% A.~Someone, B.~Someone, and C.~Someone, ``The title of the journal paper,''
%  {\em Journal of New Music Research}, vol.~A, pp.~111--222, September 2010.
%
% \bibitem{Person:20}
% O.~Person, {\em Title of the Book}.
% \newblock Montr\'{e}al, Canada: McGill-Queen's University Press, 2021.
%
% \bibitem{Person:09}
% F.~Person and S.~Person, ``Title of a chapter this book,'' in {\em A Book
% Containing Delightful Chapters} (A.~G. Editor, ed.), pp.~58--102, Tokyo,
% Japan: The Publisher, 2009.
%
%
%\end{thebibliography}

\end{document}

